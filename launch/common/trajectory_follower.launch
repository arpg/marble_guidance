<launch>

    <!-- <arg name="enable_debug" /> -->
    <arg name="vehicle_name" default="X1"/>
    <arg name="enable_ground_truth" default="true"/>

    <node pkg="marble_guidance" type="trajectory_follower_node" name="trajectory_follower" output="screen">
        <!-- TOPICS -->
        <remap from="trajectory_follower/odometry_map" to="odometry_map"/>
        <remap from="trajectory_follower/cartographer_trajectory" to="pose_graph"/>
        <remap from="trajectory_follower/liosam_trajectory" to="lio_sam/mapping/path"/>
        <remap from="trajectory_follower/follow_traj" to="fake_follow_traj"/>
        <remap from="trajectory_follower/ground_truth_trajectory" to="trajectory_generator/ground_truth_trajectory"/>

        <param name="vehicle_name" value="$(arg vehicle_name)"/>
        <param name="enable_ground_truth" value="$(arg enable_ground_truth)"/>

        <param name="loop_rate"                       value="20.0"/>
        <param name="yawrate_k0"                      value="1.0"/>
        <param name="yawrate_kd"                      value="1.0"/>
        <param name="max_yawrate"                     value="0.5"/>
        <param name="max_forward_speed"               value="0.75"/>
        <param name="turn_in_place_thresh"            value="1.5"/>
        <param name="turn_in_place_yawrate"           value="0.25"/>
        <param name="enable_speed_regulation"         value="true"/>
        <param name="yaw_error_k"                     value="1.0"/>
        <param name="lookahead_distance_threshold"    value="1.0"/>

    </node>

    <node pkg="marble_guidance" type="trajectory_generator" name="trajectory_generator_node" if="$(arg enable_ground_truth)">
        <remap from="trajectory_generator/odometry_map" to="odometry_map"/>
    </node>

    <include file="$(find lcd_pkg)/launch/lcd.launch" unless="$(arg enable_ground_truth)"/>

</launch>
